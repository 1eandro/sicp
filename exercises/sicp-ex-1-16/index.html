<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.80.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Exercise 1.16 &middot; Ben&#39;s Solutions to Sicp</title>
  <meta name="description" content="" />

  
  <link type="text/css" rel="stylesheet" href="https://benjamin-philip.github.io/sicp/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://benjamin-philip.github.io/sicp/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://benjamin-philip.github.io/sicp/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://benjamin-philip.github.io/sicp/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js" integrity="sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
<script>
 document.addEventListener("DOMContentLoaded", function() {
     renderMathInElement(document.body, {
         
         
         delimiters: [
             {left: '$$', right: '$$', display: true},
             {left: '$', right: '$', display: false},
             {left: '\\(', right: '\\)', display: false},
             {left: '\\[', right: '\\]', display: true}
         ],
         
         throwOnError : false
     });
 });
</script>


</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://benjamin-philip.github.io/sicp/"><h1>Ben&#39;s Solutions to Sicp</h1></a>
      <p class="lead">
       My journey reading Sicp: From learning scheme to building an interpreter. 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://benjamin-philip.github.io/sicp/">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2021. All rights reserved. </p>
  </div>
</aside>

      <main class="content container">
          <div class="post">
  <h1>Exercise 1.16</h1>
  <time datetime=2020-11-12T00:00:00Z class="post-date">Thu, Nov 12, 2020</time>
  <p>This is the 16th Question. Here we design and iterative
procedure for exponentiation which uses a logarithmic number
of steps.</p>
<h1 id="the-question">The Question</h1>
<p><strong>Exercise 1.16:</strong> Design a procedure that evolves an iterative
exponentiation process that uses successive squaring and uses a
logarithmic number of steps, as does <code>fast-expt</code>. (Hint: Using the
observation that $(b^{n/2})^{2} = (b^{2})^{n/2}$, keep along with
the exponent <em>n</em> and the base <em>b</em>, an additional state variable <em>a</em>,
define the state transformation in such a way that the product $ab^{n}$
is unchanged from state to state. At the beginning of process $a$ at the
end of the process. In general, the technique of defining an <em>invariant
quantity</em> that remains unchanged from state to state is a powerful way
to think about the design of iterative algorithms.)</p>
<h1 id="my-thoughts">My Thoughts</h1>
<p>Let&rsquo;s quickly take a recap of what happens inside <code>fast-expt</code>.</p>
<h2 id="regular-expt">Regular expt</h2>
<p>Let&rsquo;s say you have to multiply a number to certain power.. Say, 16.
One way to do this to multiply the number by itself 16 times.
This becomes the following procedure:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(expt n power)
  (<span style="color:#a6e22e">expt-iter</span> n <span style="color:#ae81ff">1</span> power))

(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">expt-iter</span> n mul count)
  (<span style="color:#66d9ef">if </span>(= count <span style="color:#ae81ff">0</span>)
      mul
      (<span style="color:#a6e22e">expt-iter</span> n (* mul n) (- count <span style="color:#ae81ff">1</span>))))
</code></pre></div><p>Now this <em>okay</em> for smaller powers. It has the order of growth of
$\theta(n)$ So the moment your program starts going to larger numbers
like 10,000 or 100,000 , you will have to execute 10,000 or 100,000
steps to achieve a value.  The thing is that, this is very inefficient
for the larger powers.</p>
<h2 id="a-faster-alternative">A faster alternative</h2>
<p>Now, let&rsquo;s say you wanted a more efficient way
to multiply your the same number to power of 16.
This is what we can do:</p>
<p>$$ b \times b $$<br>
$$ b^{2} \times b^{2} $$<br>
$$ b^{4} \times b^{4} $$<br>
$$ b^{8} \times b^{8} = b^{16} $$</p>
<p>We now only take 4 multiplications. 4x faster!</p>
<p>This works as long as the power is a power of 2.
So what do you when you need to multiply to the power of 5?</p>
<p>$$ b \times b $$<br>
$$ b^{2} \times b^{2} $$<br>
$$ b^{4} \times b^{1} = b^{1} $$</p>
<p>Take gives you a very vague idea of what we are going to do.
Let&rsquo;s make the general rule that if a number is odd, we will
express it as the following :</p>
<p>$$ b^{n} = b \times b^{n - 1} $$</p>
<p>We can now describe <code>fast-exp</code> as the following recursive procedure:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">fast-exp</span> b n)
  (<span style="color:#66d9ef">cond </span>((= n <span style="color:#ae81ff">0</span>) <span style="color:#ae81ff">1</span>)
        ((even? n) (<span style="color:#a6e22e">square</span> (<span style="color:#a6e22e">fast-expt</span> b (/ n <span style="color:#ae81ff">2</span>))))
        (<span style="color:#66d9ef">else </span>(* b (<span style="color:#a6e22e">fast-expt</span> b (- n <span style="color:#ae81ff">1</span>))))))
</code></pre></div><p>where <code>even?</code> is the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(even? n)
  (= (remainder n <span style="color:#ae81ff">2</span>) <span style="color:#ae81ff">0</span>))
</code></pre></div><p>This procedure now has $\theta(\log n)$
We need to convert this to an Iterative Procedure</p>
<h2 id="what-does-the-hint-mean">What does the Hint mean?</h2>
<p>The Hint says that we must have 3 variables: <code>b</code> the base,
<code>n</code> the exponent and <code>a</code> the &ldquo;state&rdquo; and define the state
transformation in such a way that, the product of $ab^{n}$
will be kept unchanged from state to state.</p>
<p>It also says that at the beginning of the process $a$ is taken
to be 1, and the answer is given by the value of $a$ at the end
of the process.</p>
<p>In general, the technique of defining an <em><strong>invariant quantity</strong></em>
that remains unchanged from state to state is a powerful way
to think about the design of iterative algorithms.</p>
<h1 id="the-answer">The Answer</h1>
<p>Let&rsquo;s assume that we have to find $3^{3}$. We have the variables, <code>b</code>,
<code>n</code>, <code>a</code>. <code>b</code> is our <em>current</em>  base, <code>n</code> the <em>current</em> exponent, we will
also have <code>base</code> to remember the original base&hellip; And something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#a6e22e">expt-iter</span> b n a base) <span style="color:#75715e">;;This the order of the variables</span>
(<span style="color:#a6e22e">expt-iter</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>)
(<span style="color:#a6e22e">expt-iter</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>)
(<span style="color:#a6e22e">expt-iter</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">3</span>)
<span style="color:#ae81ff">27</span>
</code></pre></div><p>This should give you a vague idea of what we do.
Here is the detailed explanation:</p>
<p>We square <code>b</code> every iteration and divide <code>n</code> by two.
This iteration goes on until <code>n</code> is 1, which is when
we return b.</p>
<p>With that description we derive the following procedure:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">fast-expt</span> b n)
  (<span style="color:#a6e22e">expt-iter</span> b n))

(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">expt-iter</span> b n)
  (<span style="color:#66d9ef">cond </span>((= n <span style="color:#ae81ff">1</span>) b)
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">expt-iter</span> (<span style="color:#a6e22e">square</span> b) (/ n <span style="color:#ae81ff">2</span>)))))
</code></pre></div><p>This works</p>
<pre><code>1 ]=&gt; (fast-expt 2 8)

;Value: 256
</code></pre><p>perfectly</p>
<pre><code>1 ]=&gt; (fast-expt 2 16)

;Value: 65536
</code></pre><p>fine</p>
<pre><code>1 ]=&gt; (fast-expt 2 32)

;Value: 4294967296
</code></pre><p>until</p>
<pre><code>1 ]=&gt; (fast-expt 2 3)

... nothing
</code></pre><p>This is because 3 becomes 1.5 which becomes 0.75 and never becomes 1.
So we now need to implement the $b \times b^{n - 1}$ thing we were
talking about before. This is where <code>a</code> and <code>base</code> come in.</p>
<p><code>a</code> is where we store the product of all the &ldquo;single &lsquo;b&rsquo; s&rdquo;. We multiply
<code>b</code> with <code>a</code> at the end of the iteration. But how do we know what is the
value of the original <code>b</code>? This is why store the value of b in <code>base</code>.</p>
<p>We lastly need a way to a way to check if a number is even or not. That
will be following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(even? n)
  (= (remainder n <span style="color:#ae81ff">2</span>) <span style="color:#ae81ff">0</span>))
</code></pre></div><p>This is will be our new <code>fast-expt</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">fast-expt</span> b n)
  (<span style="color:#a6e22e">expt-iter</span> b n <span style="color:#ae81ff">1</span> b))


(<span style="color:#66d9ef">define </span>(<span style="color:#a6e22e">expt-iter</span> b n a base)
  (<span style="color:#66d9ef">cond </span>((= n <span style="color:#ae81ff">1</span>) (* a b))
        ((not (even? n)) (<span style="color:#a6e22e">expt-iter</span> b (- n <span style="color:#ae81ff">1</span>) (* a base) base))
        (<span style="color:#66d9ef">else </span>(<span style="color:#a6e22e">expt-iter</span> (<span style="color:#a6e22e">square</span> b) (/ n <span style="color:#ae81ff">2</span>) a base))))
</code></pre></div><p>And <strong>now</strong> it works fine:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scheme" data-lang="scheme">(<span style="color:#a6e22e">fast-expt</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span>)

<span style="color:#75715e">;Value: 8</span>
</code></pre></div>
</div>


      </main>

      
      
      
  </body>
</html>
